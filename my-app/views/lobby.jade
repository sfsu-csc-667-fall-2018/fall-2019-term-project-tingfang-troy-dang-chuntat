extends layout

block content
	script(src="/socket.io/socket.io.js")
	script.
		var socket = io();
		socket.on('connect', () => {
		socket.emit("joinLobby", "#{username}" )

		socket.on('updateUser', function (data) {
		$('#conversation').append('<p>' + data + '<p>'); });

		socket.on('updateChat', function (username, data) {
		$('#conversation').append('<p>'+username + ':' + data + '<p>'); });
		}  );

		$(function(){
		// when the client clicks SEND
		$('#datasend').click( function() {
			var message = $('#data').val();
			$('#data').val('');
			// tell server to execute 'sendchat' and send along one parameter
			socket.emit('sendChat', message);
		}); });

	div.navbar
		ul
			li
				a(href="/") Texas Hold em
			li 
				a(href="/logout") Log out

	
	//- div.gamerooms
	//- 	section
	//- 		div.pageSwitch
	//- 			- var next = +page+1
	//- 			- var last = +page-1
	//- 			- var lastPage = Math.floor(+rooms.length/9)
	//- 			if page > 0
	//- 				a(href="/lobby/" + last) ←
	//- 			if page < lastPage
	//- 				a(href="/lobby/" + next) →

	//- 			ul

	//- 				//calculate how many rooms to list out
	//- 				- var lastRoom = +rooms.length
	//- 				if lastRoom > +page*9+9
	//- 					- lastRoom = +page*9+9

	//- 				//Spawn rooms (For Loop)
	//- 				- for (var i = +page*9; i < lastRoom; ++i) {
	//- 					li = rooms[i]
	//- 						p  Game Room #{rooms[i].id}
	//- 						p (0/8)
	//- 						a(href="api/games/#{rooms[i].id}" + rooms[i].id) Join
	//- 				- }

	div.gamerooms
		
		section Welcome #{username}  
			ul
				for val in rooms
					li 
						p Game Room #{val.id}
						p (0/8)
						a(href="/api/games/#{val.id}") Join

	div.rightArticle
		article
			div.buttons
				button
					a(href="/games/create") Play Now
				button 
					a(href="/games/create") Create Now
			div.log
				div.logContent
					div
						p#conversation
			div.chatbox
				label(for='message')
				input(type='message', name='message', id = 'data')
				button(type='submit' ,id ='datasend') send

	

